<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Isikukoodi genraator ja validaator</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <main>
      <h1>Estonian Personal ID</h1>

      <form id="form-personal-id">
        <p>Validate or generate personal Estonian ID</p>
        <div class="input">
          <input type="text" name="personal-id" id="personal-id" placeholder="11-digit personal number"
            aria-label="11-digit personal number" maxlength="11" required>
          <button type="submit" class="minimal">Validate</button>
          <button id="generate" class="minimal">Generate</button>
        </div>
        <output id="result" class="result invalid"></output>
      </form>
    </main>

    <script type="module">
      import Isikukood from '../dist/isikukood.esm.js';
      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('form-personal-id');
        const personalIdInput = document.getElementById('personal-id');
        const resultElem = document.getElementById('result');
        const generateBtn = document.getElementById('generate');


        form.addEventListener('submit', (event) => {
          event.preventDefault();
          const isikukood = new Isikukood(personalIdInput.value);
          if (isikukood.validate()) {
            form.classList.remove('-invalid');
            resultElem.textContent = 'Personal ID is valid';
          } else {
            form.classList.add('-invalid');
            resultElem.textContent = 'Personal ID is invalid';
          }
        });

        generateBtn.addEventListener('click', (event) => {
          event.preventDefault();
          personalIdInput.value = Isikukood.generate();
          resultElem.textContent = '';
          form.classList.remove('-invalid');
        });
      });
    </script>
  </body>
</html>